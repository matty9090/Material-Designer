version: 0.0.{build}
image: Visual Studio 2017

branches:
   only:
     - master

environment:
  matrix:
    - GENERATOR: "Visual Studio 15"
      CONFIG: Debug

    - GENERATOR: "Visual Studio 15"
      CONFIG: Release

    - GENERATOR: "Visual Studio 15 Win64"
      CONFIG: Debug

    - GENERATOR: "Visual Studio 15 Win64"
      CONFIG: Release

build_script:
  - cmd: git submodule update --init --recursive
  - cmd: mkdir Build
  - cmd: cd Build
  - cmd: cmake -G "%GENERATOR%" -DINSTALL_GTEST=0 -DBUILD_GMOCK=0 ..
  - cmd: cmake --build . --config "%CONFIG%"

test_script:
  - ctest -VV -C "%CONFIG%"